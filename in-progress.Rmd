---
title: "EDLD 651 Final"
author: "Alex Newson, Deanna Strayer, Sabreen NoorAli, Seulbi Lee, Tony Daza"
date: "`r Sys.Date()`"
output: html_document
---

```{r setup, include=FALSE}
library(dplyr)
library(readr)
library(tidyr)
```

### Research Question
##### Do the teacher's reported student math scores across the two timepoints (i.e., base year and first follow-up) correlate with 1) students' sex, 2) students' race/ethnicity, and 3) mother's highest education level of students?

### Independent Variables: 
##### 1.[BYSEX]
#######  1 = "Male"
#######  2 = "Female"
####### -4 = "Nonrespondent"
####### -8 = "Survey component legitimate skip/NA"
##### 2. [BYRACE]
#######  1 = "Amer. Indian/Alaska Native, non-Hispanic"
#######  2 = "Asian, Hawaii/Pac. Islander,non-Hispanic"
#######  3 = "Black or African American, non-Hispanic"
#######  4 = "Hispanic, no race specified"
#######  5 = "Hispanic, race specified"
#######  6 = "More than one race, non-Hispanic"
#######  7 = "White, non-Hispanic"
#######  -4 = "Nonrespondent"
#######  -8 = "Survey component legitimate skip/NA"
##### 3. [BYMOTHED]
#######  1 = "Did not finish high school"
#######  2 = "Graduated from high school or GED"
#######  3 = "Attended 2-year school, no degree"
#######  4 = "Graduated from 2-year school"
#######  5 = "Attended college, no 4-year degree"
#######  6 = "Graduated from college"
#######  7 = "Completed Master's degree or equivalent"
#######  8 = "Completed PhD, MD, other advanced degree"
#######  -4 = "Nonrespondent"
#######  -8 = "Survey component legitimate skip/NA"
#######  -9 = "Missing"

### Dependent Variables: 
##### 1. [BYTXMSTD] Math test standardized score 
####### Description: Math standardized T Score. The standardized T score provides a norm-referenced measurement of achievement, that is, an estimate of
achievement relative to the population (spring 2002 10th-graders) as a whole. It provides information on status compared to peers (as distinguished from the IRT-estimated number-right score which represents status with respect to achievement on a particular
criterion set of test items). The standardized T score is a transformation of the IRT theta (ability) estimate, rescaled to a mean of 50 and standard deviation of 10.
##### 2. [F1TXMSTD] F1 math test standardized score 
####### Description: Math standardized T Score. The standardized T score provides a norm-referenced measurement of achievement, that is, an estimate of achievement relative to the population (spring 2004 12th-graders) as a whole. It provides information on status compared with peers (as distinguished from the IRT-estimated number-right score which represents status with respect to achievement on a particular criterion set of test items). Although the T score is reported for
all F1 in-school responding students (including transfer students), regardless of grade level, the comparison group for standardizing is the 12th grade population. The standardized T score is a transformation of the IRT theta (ability) estimate, and has a mean of 50 and standard deviation of 10 for the weighted subset of 12th-graders in the sample.

```{r requirement checklist to be deleted}
#!!! mark O next to the criteria met !!!
#Is document fully reproducible? (in Seulbi's run) o
#Is document fully reproducible? (in Sabreen's run) 
#Is document fully reproducible? (in Tony's run)
#Is document fully reproducible? (in Deanna's run)
#Is document fully reproducible? (in Alex's run)
#Does it include inline codes? 
#Do we have two visualizations?
#Used pivot_longer() o
#used mutate() o
#used select() o
#used filter () o
#used pivot_wider() o
#used group_by()
#used summarize()

```

### Data Cleaning 

```{r data cleaning}

# final requirement: pivot_longer(), mutate(), select(), filter(), pivot_wider()

#retrieve data
#els <- read_csv("./data/els_02_12_byf3pststu_v1_0.csv")
#select columns 
#els <- els %>% dplyr::select(STU_ID, BYSEX, BYRACE, BYMOTHED, BYTXMSTD, F1TXMSTD)
#save the revised (cleaned) data to csv
#write.csv(els,"./data/els_cleaned.csv", row.names = FALSE)

els <- read_csv("./data/els_cleaned.csv")

#replace missing data code to NA
els$BYSEX <- na_if(els$BYSEX, -4)
els$BYSEX <- na_if(els$BYSEX, -8)
els$BYRACE <- na_if(els$BYRACE, -4)
els$BYRACE <- na_if(els$BYRACE, -8)
els$BYMOTHED <- na_if(els$BYMOTHED, -4)
els$BYMOTHED <- na_if(els$BYMOTHED, -8)
els$BYMOTHED <- na_if(els$BYMOTHED, -9)
els$BYTXMSTD <- na_if(els$BYTXMSTD, -8)
els$F1TXMSTD <- na_if(els$F1TXMSTD, -8)

#remove if the row doesn't have both BY and F1 math scores
els <- els %>% 
  filter(!is.na(BYTXMSTD) | !is.na(F1TXMSTD))

#rename
els <- els %>%
  mutate(BYSEX = recode(BYSEX, 
                          `1` = "Male", 
                          `2` = "Female"),
         BYRACE = recode(BYRACE, 
                          `1` = "Native American/Alaskan", 
                          `2` = "Asian", 
                          `3` = "Black", 
                          `4` = "Hispanic (no race specified)", 
                          `5` = "Hispanic (specified)", 
                          `6` = "More than one race, non-Hispanic", 
                          `7` = "White, non-Hispanic"),
         BYMOTHED = recode(BYMOTHED,
                          `1` = "Did not finish high school",
                          `2` = "Graduated from high school or GED",
                          `3` = "Attended 2-year school, no degree",
                          `4` = "Graduated from 2-year school",
                          `5` = "Attended college, no 4-year degree",
                          `6` = "Graduated from college",
                          `7` = "Completed Master's degree or equivalent",
                          `8` = "Completed PhD, MD, other advanced degree"))


#rename columns to use pivot_longer
colnames(els)[colnames(els) %in% c("BYTXMSTD", "F1TXMSTD")] <- c("Base", "Follow-up")

els_longer <- els %>% 
  pivot_longer(
    cols = c('Base', 'Follow-up'),
    names_to = "YEAR",
    values_to = "MATH"
  )

els_wider_by <- els %>% 
  pivot_wider(
    id_cols = !'Follow-up',
    names_from = BYRACE,
    values_from = c(Base)
  )

els_wider_f1 <- els %>% 
  pivot_wider(
    id_cols = !Base,
    names_from = BYRACE,
    values_from = c('Follow-up')
  )

```


```{r visualization 1}

```


```{r visualization 2}

```


```{r descriptive}

```
